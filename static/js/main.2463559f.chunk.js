(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{11:function(e,t,n){e.exports=n(17)},16:function(e,t,n){},17:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),c=n(6),r=n.n(c),i=(n(16),n(10)),s=n(1),u=n(7),l=n(8),p={baseUrl:"https://nomoreparties.co/cohort7",headers:{authorization:"4d8a3a8e-7975-4987-a6e2-1615458dac98","Content-Type":"application/json"}},d=new(function(){function e(t){Object(u.a)(this,e),this.options=t}return Object(l.a)(e,[{key:"getUserInfo",value:function(){return fetch(this.options.baseUrl+"/users/me",{headers:this.options.headers}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))})).catch((function(e){console.log(e)}))}},{key:"getInitialCards",value:function(){return fetch(this.options.baseUrl+"/cards",{headers:this.options.headers}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))})).catch((function(e){console.log(e)}))}},{key:"editProfile",value:function(e,t){return fetch(this.options.baseUrl+"/users/me",{method:"PATCH",headers:this.options.headers,body:JSON.stringify({name:e,about:t})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))})).then((function(e){return e})).catch((function(e){console.log(e)}))}},{key:"addNewCard",value:function(e,t){return fetch(this.options.baseUrl+"/cards",{method:"POST",headers:this.options.headers,body:JSON.stringify({name:e,link:t})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))})).then((function(e){return e})).catch((function(e){console.log(e)}))}},{key:"addLike",value:function(e){return fetch(this.options.baseUrl+"/cards/like/".concat(e),{method:"PUT",headers:this.options.headers,body:JSON.stringify({owner:{_id:"033a1b11aedbbdef4a2f8447"}})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))})).then((function(e){return e})).catch((function(e){return console.log(e)}))}},{key:"deleteLike",value:function(e){return fetch(this.options.baseUrl+"/cards/like/".concat(e),{method:"DELETE",headers:this.options.headers,body:JSON.stringify({owner:{_id:"033a1b11aedbbdef4a2f8447"}})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))})).then((function(e){return e})).catch((function(e){return console.log(e)}))}},{key:"deleteCardFromServer",value:function(e){return fetch(this.options.baseUrl+"/cards/".concat(e),{method:"DELETE",headers:this.options.headers,body:JSON.stringify({owner:{_id:"033a1b11aedbbdef4a2f8447"}})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))})).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}},{key:"newAvatar",value:function(e){return fetch(this.options.baseUrl+"/users/me/avatar",{method:"PATCH",headers:this.options.headers,body:JSON.stringify({avatar:e})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))})).catch((function(e){return console.log(e)}))}}]),e}())(p),m=n(9),f=n.n(m),_=function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("header",{className:"header root__section"},o.a.createElement("img",{src:f.a,alt:"mesto logo",className:"logo"})))};var h=function(e){var t=e.card,n=e.onCardClick,a=e.id,c=e.onCardLike,r=e.onCardDelete,i=t.owner._id===a,s=t.likes.some((function(e){return e._id===a})),u="".concat(s?"place-card__like-icon place-card__like-icon_liked":"place-card__like-icon");return o.a.createElement("div",{className:"place-card"},o.a.createElement("div",{className:"place-card__image",style:{backgroundImage:"url(".concat(t.link,")")},onClick:function(){return n(t)}},i?o.a.createElement("button",{className:"place-card__delete-icon",onClick:function(e){return function(e){if(e.stopPropagation(),window.confirm("\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0443?"))return r(t)}(e)}}):null),o.a.createElement("div",{className:"place-card__description"},o.a.createElement("h3",{className:"place-card__name"},t.name),o.a.createElement("div",{className:"place-card__container"},o.a.createElement("button",{className:u,onClick:function(){return c(t)}}),o.a.createElement("span",{className:"place-card__like-count"},t.likes.length))))},b=o.a.createContext(),v=function(e){var t=Object(a.useContext)(b),n=t.name,c=t.about,r=t.avatar,i=t._id;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"profile root__section"},o.a.createElement("div",{className:"user-info"},o.a.createElement("div",{className:"user-info__photo",style:{backgroundImage:"url(".concat(r,")")},onClick:e.onEditAvatar}),o.a.createElement("div",{className:"user-info__data"},o.a.createElement("h1",{className:"user-info__name"},n),o.a.createElement("p",{className:"user-info__job"},c),o.a.createElement("button",{onClick:e.onEditProfile,className:"button user-info__edit-button"},"Edit")),o.a.createElement("button",{onClick:e.onAddPlace,className:"button user-info__button"},"+"))),o.a.createElement("div",{className:"places-list root__section"},e.cards.slice(0,10).map((function(t,n){return o.a.createElement(h,{card:t,key:n,onCardClick:e.onCardClick,id:i,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete})})),e.children))},g=n(4),E=n.n(g),k=function(e){var t=e.card,n=e.isOpen,a=e.onClose,c=n?"popup_is-opened":"";return o.a.createElement("div",{className:"popup popup_image ".concat(c)},o.a.createElement("div",{className:"popup__image-container"},o.a.createElement("img",{src:t.link,alt:"",className:"popup__src-image"}),o.a.createElement("img",{src:E.a,alt:"",className:"popup__close popup__image-close",onClick:a})))};var j=function(e){var t=e.isOpen,n=e.title,a=e.name,c=e.children,r=e.button,i=e.onClose,s=e.onSubmit,u=e.loading,l=t?"popup_is-opened":"",p=u?"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...":r;return o.a.createElement("div",{className:"popup ".concat(a," ").concat(l)},o.a.createElement("div",{className:"popup__content"},o.a.createElement("img",{src:E.a,alt:"",className:"popup__close",onClick:i}),o.a.createElement("h3",{className:"popup__title"},n),o.a.createElement("form",{className:"popup__form",name:a,onSubmit:s},c,o.a.createElement("button",{disabled:!!u,type:"submit",className:"button popup__button popup__button_add"},p))))};var O=function(e){var t=Object(a.useState)(""),n=Object(s.a)(t,2),c=n[0],r=n[1],i=Object(a.useState)(""),u=Object(s.a)(i,2),l=u[0],p=u[1],d=Object(a.useState)(!1),m=Object(s.a)(d,2),f=m[0],_=m[1],h=Object(a.useState)(!1),v=Object(s.a)(h,2),g=v[0],E=v[1],k=Object(a.useContext)(b);return Object(a.useEffect)((function(){r(k.name),p(k.about)}),[k]),o.a.createElement(j,{name:"popup__user-info",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",button:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateUser(c,l)},loading:e.loading},o.a.createElement("input",{value:c,type:"text",name:"userName",className:"popup__input popup__input_type_user-name",placeholder:"\u0418\u043c\u044f",required:!0,onChange:function(e){0===e.target.value.length?_(!0):_(!1),r(e.target.value)}}),f?o.a.createElement("p",{className:"popup__name-error"},"\u041f\u043e\u043b\u0435 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c"):null,o.a.createElement("input",{value:l,type:"text",name:"userJob",className:"popup__input popup__input_type_user-job",placeholder:"\u041e \u0441\u0435\u0431\u0435",required:!0,onChange:function(e){0===e.target.value.length?E(!0):E(!1),p(e.target.value)}}),g?o.a.createElement("p",{className:"popup__job-error"},"\u041f\u043e\u043b\u0435 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c"):null)};var C=function(e){var t=Object(a.useRef)(null);return o.a.createElement(j,{name:"popup__avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",button:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(n){n.preventDefault(),e.onUpdateAvatar(t.current.value)},loading:e.loading},o.a.createElement("input",{ref:t,type:"url",name:"userAvatar",className:"popup__input popup__input_type_avatar",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440",required:!0}),o.a.createElement("p",{className:"popup__name-error"}))};var N=function(e){var t=Object(a.useState)(""),n=Object(s.a)(t,2),c=n[0],r=n[1],i=Object(a.useState)(""),u=Object(s.a)(i,2),l=u[0],p=u[1];return o.a.createElement(j,{name:"popup-place",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",button:"+",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdatePlace(c,l)},loading:e.loading},o.a.createElement("input",{value:c,type:"text",name:"name",className:"popup__input popup__input_type_name",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",required:!0,onChange:function(e){r(e.target.value)}}),o.a.createElement("input",{value:l,type:"url",name:"link",className:"popup__input popup__input_type_link-url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0,onChange:function(e){p(e.target.value)}}))};var y=function(){var e=Object(a.useState)(!1),t=Object(s.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(!1),u=Object(s.a)(r,2),l=u[0],p=u[1],m=Object(a.useState)(!1),f=Object(s.a)(m,2),h=f[0],g=f[1],E=Object(a.useState)(!1),j=Object(s.a)(E,2),y=j[0],S=j[1],P=Object(a.useState)({}),U=Object(s.a)(P,2),w=U[0],A=U[1],L=Object(a.useState)({}),T=Object(s.a)(L,2),x=T[0],D=T[1],J=Object(a.useState)([]),I=Object(s.a)(J,2),q=I[0],F=I[1],B=Object(a.useState)(!1),H=Object(s.a)(B,2),W=H[0],z=H[1];function M(e){e(!1)}return Object(a.useEffect)((function(){d.getUserInfo().then((function(e){D(e)}))}),[]),Object(a.useEffect)((function(){d.getInitialCards().then((function(e){F(e.reverse())}))}),[]),o.a.createElement(o.a.Fragment,null,o.a.createElement(_,null),o.a.createElement(b.Provider,{value:x},o.a.createElement(v,{cards:q,onEditProfile:function(){c(!0)},onAddPlace:function(){p(!0)},onEditAvatar:function(){g(!0)},onCardClick:function(e){S(!0),A(e)},onCardLike:function(e){e.likes.some((function(e){return e._id===x._id}))?d.deleteLike(e._id).then((function(t){var n=q.map((function(n){return n._id===e._id?t:n}));F(n)})):d.addLike(e._id).then((function(t){var n=q.map((function(n){return n._id===e._id?t:n}));F(n)}))},onCardDelete:function(e){d.deleteCardFromServer(e._id),F(q.filter((function(t){return t!==e})))}},o.a.createElement(N,{isOpen:l,onClose:function(){return M(p)},onUpdatePlace:function(e,t){z(!0),setTimeout((function(){d.addNewCard(e,t).then((function(e){F([e].concat(Object(i.a)(q))),z(!1)}))}),1e3)},loading:W}),o.a.createElement(O,{isOpen:n,onClose:function(){return M(c)},onUpdateUser:function(e,t){z(!0),setTimeout((function(){d.editProfile(e,t).then((function(e){D(e),z(!1)}))}),1e3)},loading:W}),o.a.createElement(C,{isOpen:h,onClose:function(){return M(g)},onUpdateAvatar:function(e){z(!0),setTimeout((function(){d.newAvatar(e).then((function(e){D(e),z(!1)}))}),1e3)},loading:W}),o.a.createElement(k,{card:w,isOpen:y,onClose:function(){return M(S)}}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(y,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},4:function(e,t,n){e.exports=n.p+"static/media/close.a3e3d9bd.svg"},9:function(e,t,n){e.exports=n.p+"static/media/logo.9d0e3a93.svg"}},[[11,1,2]]]);
//# sourceMappingURL=main.2463559f.chunk.js.map